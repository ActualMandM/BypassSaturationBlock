// v1.00: 0x1412BD2C0
// v1.01: 0x1412B7290
bool* visualSetting;

// v1.00: 0x1416EB758
// v1.01: 0x1416E5748
int32_t* style;

// v1.00: 0x1406888D0
// v1.01: 0x140683430
SIG_SCAN
(
	sigCustomizationStyle,
	"\x48\x83\xEC\x28\xE8\x00\x00\x00\x00\x88\x41\x2C\xE8\x00\x00\x00\x00\x88\x41\x2D\xE8\x00\x00\x00\x00\x88\x41\x2E\xE8\x00\x00\x00\x00\x88\x41\x2F\xE8\x00\x00\x00\x00\x88\x41\x30\xE8\x00\x00\x00\x00\x88\x41\x31\xE8\x00\x00\x00\x00\x88\x41\x32\xE8\x00\x00\x00\x00\x88\x41\x33\xE8\x00\x00\x00\x00\xB2\x01\xE8\x00\x00\x00\x00\xE8\x00\x00\x00\x00\x33\xD2\xE8\x00\x00\x00\x00\xB2\x01\xE8\x00\x00\x00\x00\xE8\x00\x00\x00\x00\xE8\x00\x00\x00\x00\xE8\x00\x00\x00\x00\xE8\x00\x00\x00\x00\xE8\x00\x00\x00\x00\x33\xD2\xE8\x00\x00\x00\x00\xE8\x00\x00\x00\x00\xE8\x00\x00\x00\x00\xE8\x00\x00\x00\x00\x0F\x57\xC9\xE8\x00\x00\x00\x00\xF3\x0F\x10\x0D\x00\x00\x00\x00\xE8\x00\x00\x00\x00\xF3\x0F\x10\x0D\x00\x00\x00\x00\xE8\x00\x00\x00\x00\xF3\x0F\x10\x0D\x00\x00\x00\x00\x48\x83\xC4\x28\xE9\x00\x00\x00\x00",
	"xxxxx????xxxx????xxxx????xxxx????xxxx????xxxx????xxxx????xxxx????xxxx????xxx????x????xxx????xxx????x????x????x????x????x????xxx????x????x????x????xxxx????xxxx????x????xxxx????x????xxxx????xxxxx????"
);

// v1.00: 0x14040FFA0
// v1.01: 0x14040B370
SIG_SCAN
(
	sigNPRArchive,
	"\x48\x89\x5C\x24\x00\x48\x89\x6C\x24\x00\x48\x89\x74\x24\x00\x57\x48\x83\xEC\x20\x33\xED\x48\xC7\x41\x00\x00\x00\x00\x00\x48\x8B\xF9\x48\x89\x29\x48\x89\x69\x08\x48\x8D\x99\x00\x00\x00\x00\x40\x88\x69\x10\x8D\x75\x04\x48\x89\x69\x14\x66\x89\x69\x1C\x89\x69\x28\xC7\x41\x00\x00\x00\x00\x00\x48\x8D\x8B\x00\x00\x00\x00\xC7\x83\x00\x00\x00\x00\x00\x00\x00\x00\x40\x88\xAB\x00\x00\x00\x00\x48\xC7\x83\x00\x00\x00\x00\x00\x00\x00\x00\x66\x89\xAB\x00\x00\x00\x00\x48\x89\xAB\x00\x00\x00\x00\x48\x89\xAB\x00\x00\x00\x00\x48\x89\xAB\x00\x00\x00\x00\xE8\x00\x00\x00\x00\x48\x8D\x8B\x00\x00\x00\x00\xE8\x00\x00\x00\x00\x48\x8D\x8B\x00\x00\x00\x00\xE8\x00\x00\x00\x00\x48\x8D\x8B\x00\x00\x00\x00\xE8\x00\x00\x00\x00\xB8\x00\x00\x00\x00\x4C\x8D\x8B\x00\x00\x00\x00\x0F\x1F\x40\x00\x41\xC7\x41\x00\x00\x00\x00\x00\x49\xC7\x41\x00\x00\x00\x00\x00\x41\x88\x29\x49\xC7\x41\x00\x00\x00\x00\x00\x41\x88\x69\x0C\x49\xC7\x41\x00\x00\x00\x00\x00\x41\x88\x69\x18\x49\xC7\x41\x00\x00\x00\x00\x00\x41\x88\x69\x24\x49\xC7\x41\x00\x00\x00\x00\x00\x41\x88\x69\x30\x49\x89\x69\xF0\x4D\x8D\x49\x48\x48\x83\xE8\x01\x75\xAF\x48\x8B\xCB\x89\x6B\xF8\xE8\x00\x00\x00\x00\x48\x8D\x4B\x18\xE8\x00\x00\x00\x00\x66\x89\x6B\x30\x40\x88\x6B\x32\xC7\x43\x00\x00\x00\x00\x00\x89\x6B\x38\xC7\x43\x00\x00\x00\x00\x00\x89\x6B\x40\x40\x88\x6B\x44\x89\x6B\x48\x48\x81\xC3\x00\x00\x00\x00\x48\x83\xEE\x01\x0F\x85\x00\x00\x00\x00\x48\x8D\x8F\x00\x00\x00\x00\xE8\x00\x00\x00\x00\x48\x8B\x5C\x24\x00\x48\x8B\x6C\x24\x00\x48\x8B\x74\x24\x00\xC7\x87\x00\x00\x00\x00\x00\x00\x00\x00\x48\x83\xC4\x20\x5F\xC3",
	"xxxx?xxxx?xxxx?xxxxxxxxxx?????xxxxxxxxxxxxx????xxxxxxxxxxxxxxxxxxxx?????xxx????xx????????xxx????xxx????????xxx????xxx????xxx????xxx????x????xxx????x????xxx????x????xxx????x????x????xxx????xxxxxxx?????xxx?????xxxxxx?????xxxxxxx?????xxxxxxx?????xxxxxxx?????xxxxxxxxxxxxxxxxxxxxxxxxx????xxxxx????xxxxxxxxxx?????xxxxx?????xxxxxxxxxxxxx????xxxxxx????xxx????x????xxxx?xxxx?xxxx?xx????????xxxxxx"
);

// v1.00: 0x1404119F0
// v1.01: 0x14040CDC0
SIG_SCAN
(
	sigStyle,
	"\x48\x89\x6C\x24\x00\x56\x48\x83\xEC\x20\x49\x8B\xF0\x48\x8B\xEA\x48\x3B\xCA\x74\x7D\x48\x89\x5C\x24\x00\x48\x8D\x59\x18\x48\x89\x7C\x24\x00\x49\x8D\x78\x28\x66\x0F\x1F\x84\x00\x00\x00\x00\x00\x8B\x43\xE8\x48\x8D\x53\xF0\x48\x8D\x4F\xE0\x89\x06\x48\x3B\xCA\x74\x12\x48\x83\x7B\x00\x00\x72\x03\x48\x8B\x12\x4C\x8B\x03\xE8\x00\x00\x00\x00\x48\x8D\x53\x10\x48\x3B\xFA\x74\x16\x48\x83\x7B\x00\x00\x72\x03\x48\x8B\x12\x4C\x8B\x43\x20\x48\x8B\xCF\xE8\x00\x00\x00\x00\x48\x83\xC3\x48\x48\x83\xC6\x48\x48\x83\xC7\x48\x48\x8D\x43\xE8\x48\x3B\xC5\x75\xA8\x48\x8B\x7C\x24\x00\x48\x8B\x5C\x24\x00\x48\x8B\x6C\x24\x00\x48\x8B\xC6\x48\x83\xC4\x20\x5E\xC3",
	"xxxx?xxxxxxxxxxxxxxxxxxxx?xxxxxxxx?xxxxxxxxx????xxxxxxxxxxxxxxxxxxxxx??xxxxxxxxx????xxxxxxxxxxxx??xxxxxxxxxxxxx????xxxxxxxxxxxxxxxxxxxxxxxxx?xxxx?xxxx?xxxxxxxxx"
);

// v1.00: 0x1401D6100
// v1.01: 0x1401D62B0
SIG_SCAN
(
	sigVisualSetting,
	"\x4D\x8B\xD1\x85\xD2\x74\x18\x83\xEA\x01\x74\x0C\x83\xFA\x01\x75\x1C\xB8\x00\x00\x00\x00\xEB\x0C\xB8\x00\x00\x00\x00\xEB\x05\xB8\x00\x00\x00\x00\x4C\x8D\x0C\x01\x4D\x85\xC9\x75\x03\x33\xC0\xC3\xB8\x00\x00\x00\x00\x41\xF7\x21\xB8\x00\x00\x00\x00\x8B\xCA\xC1\xE9\x0B\xF7\xE1\xC1\xEA\x06\x69\xC2\x00\x00\x00\x00\x2B\xC8\xB8\x00\x00\x00\x00\x41\x89\x08\x41\xF7\x21\xB8\x00\x00\x00\x00\x44\x8B\xC2\x41\xC1\xE8\x05\x41\xF7\xE0\xB8\x00\x00\x00\x00\xC1\xEA\x05\x6B\xCA\x3C\x44\x2B\xC1\x45\x89\x02\x45\x8B\x01\x41\xF7\xE0\xC1\xEA\x05\x6B\xCA\x3C\x44\x2B\xC1\x48\x8B\x4C\x24\x00\x44\x89\x01\x41\x8B\x01\xC3",
	"xxxxxxxxxxxxxxxxxx????xxx????xxx????xxxxxxxxxxxxx????xxxx????xxxxxxxxxxxx????xxx????xxxxxxx????xxxxxxxxxxx????xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx?xxxxxxx"
);

extern "C" __declspec(dllexport) void Init()
{
	// v1.00: 0x1401D6440
	// v1.01: 0x1401D65F0
	{
		uint8_t* instrAddr = (uint8_t*)sigVisualSetting() + 0x340;
		visualSetting = (bool*)(instrAddr + readUnalignedU32(instrAddr + 0x3) + 0x7);
		printf("[Future Tone Customization] visualSetting: 0x%08x\n", visualSetting);
	}

	// v1.00: 0x140411A90
	// v1.01: 0x14040CE60
	{
		uint8_t* instrAddr = (uint8_t*)sigStyle() + 0xA0;
		style = (int32_t*)(instrAddr + readUnalignedU32(instrAddr + 0x3) + 0x7);
		style -= 0x2;
		printf("[Future Tone Customization] style: 0x%08x\n", style);
	}
}

bool prevVisualSetting = (bool)-1;

extern "C" __declspec(dllexport) void OnFrame()
{
	if (prevVisualSetting != *visualSetting)
	{
		if (*visualSetting)
		{
			// v1.00: 0x140688919, 0x140688925, 0x14068892C
			// v1.01: 0x140683479, 0x140683485, 0x14068348C
			WRITE_MEMORY((uint8_t*)sigCustomizationStyle() + 0x49, uint8_t, 0xB2, 0x01);
			WRITE_MEMORY((uint8_t*)sigCustomizationStyle() + 0x55, uint8_t, 0x33, 0xD2);
			WRITE_MEMORY((uint8_t*)sigCustomizationStyle() + 0x5C, uint8_t, 0xB2, 0x01);

			// v1.00: 0x14041011A
			// v1.01: 0x14040B4EA
			WRITE_MEMORY((uint8_t*)sigNPRArchive() + 0x17A, int32_t, -1);

			WRITE_MEMORY(style, int32_t, -1);
		}
		else
		{
			WRITE_MEMORY((uint8_t*)sigCustomizationStyle() + 0x49, uint8_t, 0x33, 0xD2);
			WRITE_MEMORY((uint8_t*)sigCustomizationStyle() + 0x55, uint8_t, 0xB2, 0x01);
			WRITE_MEMORY((uint8_t*)sigCustomizationStyle() + 0x5C, uint8_t, 0x33, 0xD2);

			WRITE_MEMORY((uint8_t*)sigNPRArchive() + 0x17A, int32_t, 0);

			WRITE_MEMORY(style, int32_t, 0);
		}

		prevVisualSetting = *visualSetting;
	}
}