#include "Config.h"

// v1.0.0: 0x140279F80
SIG_SCAN
(
	sigPVMark,
	"\x40\x53\x48\x83\xEC\x60\x48\x8D\x99\x00\x00\x00\x00\x48\x8B\xCB\xE8\x00\x00\x00\x00\xF3\x0F\x10\x05\x00\x00\x00\x00\x4C\x8D\x0D\x00\x00\x00\x00\x33\xC0\x41\xB8\x00\x00\x00\x00\x48\x89\x44\x24\x00\xF3\x0F\x11\x44\x24\x00\xF3\x0F\x11\x44\x24\x00\x48\x89\x44\x24\x00\x8D\x50\x0A\x48\x89\x44\x24\x00\x8D\x48\x03\x89\x44\x24\x28\x48\x89\x44\x24\x00\xE8\x00\x00\x00\x00\x89\x03\x48\x83\xC4\x60\x5B\xC3",
	"xxxxxxxxx????xxxx????xxxx????xxx????xxxx????xxxx?xxxxx?xxxxx?xxxx?xxxxxxx?xxxxxxxxxxx?x????xxxxxxxx"
);

// v1.0.0: 0x140608360
SIG_SCAN
(
	sigCopyright,
	"\x48\x89\x5C\x24\x00\x48\x89\x4C\x24\x00\x57\x48\x83\xEC\x20\x48\x8B\xD9\x48\x8D\x05\x00\x00\x00\x00\x48\x89\x01\x33\xFF\x89\x79\x08\x48\x89\x79\x10\x48\x89\x79\x18\x48\x83\xC1\x20\xE8\x00\x00\x00\x00\x90\xC7\x43\x00\x00\x00\x00\x00\xC7\x43\x00\x00\x00\x00\x00\x48\xC7\x43\x00\x00\x00\x00\x00\x48\x8D\x4B\x40\x40\x88\x79\x08\x89\x79\x0C\x48\x8D\x05\x00\x00\x00\x00\x48\x89\x01\xBA\x00\x00\x00\x00\xFF\x15\x00\x00\x00\x00\x90\x48\x8D\x4B\x50\x40\x88\x79\x08\x89\x79\x0C\x48\x8D\x05\x00\x00\x00\x00\x48\x89\x01\xBA\x00\x00\x00\x00\xFF\x15\x00\x00\x00\x00\x90\x48\x8D\x0D\x00\x00\x00\x00\xFF\x15\x00\x00\x00\x00\x48\x8B\x08\x48\x8B\x01\xB2\x01\xFF\x50\x18\x90\x48\x8B\xC3\x48\x8B\x5C\x24\x00\x48\x83\xC4\x20\x5F\xC3",
	"xxxx?xxxx?xxxxxxxxxxx????xxxxxxxxxxxxxxxxxxxxx????xxx?????xx?????xxx?????xxxxxxxxxxxxxx????xxxx????xx????xxxxxxxxxxxxxxx????xxxx????xx????xxxx????xx????xxxxxxxxxxxxxxxxxxx?xxxxxx"
);

extern "C" __declspec(dllexport) void Init()
{
	Config::init();

	// pv_mark string
	// v1.0.0: 0x140C925F8

	if (Config::pvMark)
		WRITE_MEMORY(sigPVMark(), uint8_t, 0xC3);

	if (Config::copyrightMark)
		WRITE_MEMORY(sigCopyright(), uint8_t, 0xC3);
}
